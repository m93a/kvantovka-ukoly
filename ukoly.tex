% !TEX program = xelatex

\documentclass[10pt,a4paper]{article}
\usepackage[top = 1.5cm, bottom = 1.5cm, left = 1.5cm, right = 1.5cm]{geometry}

\usepackage{titling}
\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{csvsimple}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{units}
\usepackage{bm}
\delimitershortfall=-1pt

\usepackage{gnuplottex}
\usepackage{epstopdf}

% no page break
\newenvironment{absolutelynopagebreak}
  {\par\nobreak\vfil\penalty0\vfilneg
   \vtop\bgroup}
  {\par\xdef\tpd{\the\prevdepth}\egroup
   \prevdepth=\tpd}


% redefine \sqrt
\usepackage{letltxmacro}
\makeatletter
\let\oldr@@t\r@@t
\def\r@@t#1#2{%
\setbox0=\hbox{$\oldr@@t#1{#2\,}$}\dimen0=\ht0
\advance\dimen0-0.2\ht0
\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
{\box0\lower0.4pt\box2}}
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand*{\sqrt}[2][\ ]{\oldsqrt[#1]{#2\,}\,}
\makeatother

\def\ph{\phantom}
\def\vph{\vphantom}
\def\hph{\hphantom}

\def\?{\mathit{?}}

\newcommand{\comm}[2]{\left[ #1, #2 \right]}
\newcommand{\const}[1]{\text{\rmfamily\upshape #1}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\newcommand{\mat}[1]{
    \begin{pmatrix}
        #1
    \end{pmatrix}
}

\newcommand{\mata}[2]{
    \left(
    \begin{array}{@{}#1@{}}
        #2
    \end{array}
    \right)
}

\newcommand{\smat}[2][1]{
    \scalebox{#1}{$\mat{#2}$}
}

\renewcommand{\d}[1]{\;\const{d}#1}
\newcommand{\dd}[2]{\frac{\const{d} #1}{\const{d} #2} \;}
\newcommand{\pd}[2]{\frac{\partial  #1}{\partial  #2} \;}

\newcommand{\bra}[1]{\left< #1 \right|}
\newcommand{\ket}[1]{\left| #1 \right>}
\newcommand{\braket}[2]{\left< #1 \middle| #2 \right>}

\newcommand{\e}[1]{\const{e}^{#1}}
\renewcommand{\i}{\const{i}}

\begin{document}

\title{Kvantová mechanika I: Domácí úkoly}
\author{Michal Grňo}
\date{\today}

\maketitle

\section{Cvičení 9. 10.}

\subsection{Zadání}
Jsou dány operátory $\hat A$ a $\hat B$,
\begin{gather*}
    \comm{\hat A}{\hat B} \neq 0,
    \\[5pt]
    \comm{\hat A}{\comm{\hat A}{\hat B}} =
    \comm{\hat B}{\comm{\hat A}{\hat B}} = 0.
\end{gather*}
Nalezněte, čemu se rovná operátor $\hat C$, pro který platí
\begin{gather*}
    \e{\hat A} \, \e{\hat B} =
    \e{\hat A + \hat B} \, \e{\hat C} =
    \e{\hat C} \, \e{\hat A + \hat B} =
    \e{\hat A + \hat B + \hat C}.
\end{gather*}

\subsection{Řešení}
Na cvičení jsme se přesvědčili, že užitečným nástrojem při odvozování vztahů pro operátorovu exponenciolu je výraz $\e{\xi \hat A}$ a jeho derivace podle $\xi$. Tohoto triku využijeme i nyní – nalezneme $\hat X(\xi)$ takové, aby platilo:
\begin{align*}
    \e{\hat X(\xi)} = \e{\xi \hat A} \; \e{\xi \hat B}.
\end{align*}
Derivací vztahu získáme:
\begin{align*}
    \pd{}{\xi} \; \e{\hat X(\xi)} &= \pd{}{\xi} \; \e{\xi \hat A} \; \e{\xi \hat B}
    \\[10pt]
    \hat X'(\xi) \; \e{\hat X(\xi)} &= \hat A \; \e{\xi \hat A} \; \e{\xi \hat B} + \e{\xi \hat A} \; \hat B \; \e{\xi \hat B}
    \\[10pt]
    \hat X'(\xi) \; \e{\hat X(\xi)} &= \left( \hat A  + \e{\xi \hat A} \; \hat B \; \e{\xi \hat B} \; \e{-\xi \hat B} \; \e{-\xi \hat A} \right) \e{\xi \hat A} \e{\xi \hat B}
    \\[10pt]
    \hat X'(\xi) \; \e{\hat X(\xi)} &= \left( \hat A  + \e{\xi \hat A} \; \hat B \; \e{-\xi \hat A} \right) \e{\hat X(\xi)}
    \\[10pt]
    \hat X'(\xi) &= \hat A  + \e{\xi \hat A} \; \hat B \; \e{-\xi \hat A}
\end{align*}
Využili jsme vlastnosti, že operátor $\e{\hat A}$ je vždy regulární a jeho inverze je $\e{-\hat A}$. Připomeneme si Glauberův vzorec:
\begin{gather*}
    \e{\hat M} \; \hat N \e{-\hat M}
    = \sum_{n=0}^\infty \frac{1}{n!} \; \hat K_n(\hat M, \hat N)
    \\[10pt]
    \hat K_0(\hat M, \hat N) = \hat N
    \\[10pt]
    \hat K_{n+1}(\hat M, \hat N) = \left[ \hat M, \hat K_n \right]
\end{gather*}
Dosazením do naší rovnice získáme:
\begin{align*}
    \hat X'(\xi) &= \hat A + \sum_{n=0}^\infty \frac{1}{n!} \; \hat K_n(\xi \hat A, \hat B)
    \\[10pt]
    \hat X'(\xi) &= \hat A + \sum_{n=0}^\infty \xi^n \frac{1}{n!} \; \hat K_n(\hat A, \hat B)
    \\[10pt]
    \hat X(\xi) &= \int \left( \hat A + \sum_{n=0}^\infty \xi^n \frac{1}{n!} \; \hat K_n(\hat A, \hat B) \right) \d{\xi}
    \\[10pt]
    \hat X(\xi) &= \xi \hat A + \sum_{n=0}^\infty \frac{\xi^{n+1}}{n+1} \; \frac{1}{n!} \; \hat K_n(\hat A, \hat B) + \hat X(0)
\end{align*}
Dosazením do $\e{\hat X(\xi)} = \e{\xi \hat A} \; \e{\xi \hat B}$ vidíme, že $\hat X(0)$ musí být nula. Dosadíme-li nyní $\xi=1$, máme tedy odvozený obecný tvar Bakerovy-Campbellovy-Hausdorffovy rovnice:
\begin{align*}
    \e{\hat A} \; \e{\hat B} = \exp \left(
        \hat A + \sum_{n=0}^\infty \frac{1}{(n+1)!} \; \hat K_n(\hat A, \hat B)
    \right).
\end{align*}
Nakonec použijeme ze zadání podmínku, že operátory $\hat A, \hat B$ komutují se svým komutátorem, tedy $\hat K_0 = \hat B$, $\hat K_1 = \comm{\hat A}{\hat B}$, $\hat K_n = 0$ pro $n>1$. Konečný výsledek je tedy:
\begin{align*}
    \e{\hat A}\e{\hat B} = \e{\hat A + \hat B + \tfrac{1}{2} \comm{\hat A}{\hat B}}.
\end{align*}


\pagebreak
\section{Cvičení 16. 10.}

\subsection{Zadání první části}
Mějme dvouhladinový systém popsaný Hamiltoniánem:
\begin{align*}
    \hat H &= \hat H_0 + \hat H_1,
    \\[5pt]
    \hat H_0 &= \mat{e & 0 \\ 0 & -e},
    \\[5pt]
    \hat H_1 &= \mat{0 & \nu \\ \nu & 0}.
\end{align*}
Spočtěte vlastní hodnoty $E_{+}, E_{-}$ a vlastní vektory $\ket{E_{+}}, \ket{E_{-}}$ Hamiltoniánu, zakreslete závislost $E_{\pm}(\nu)$, vypočtěte vektory $\ket{E_{\pm}(\nu=0)}$ a $\ket{E_{\pm}(\nu\to\infty)}$.

\subsection{Řešení první části}
Začneme nalezením vlastních energií:
\begin{align*}
    &\hat H
    = \mat{ e & 0 \\ 0 & -e } + \mat{ 0 & \nu \\ \nu & 0 }
    = \mat{ e & \nu \\ \nu & -e },
    \\[15pt]
    &\det\left( \hat H - E \, \hat 1 \right)
    = -\left( e^2 - E^2 \right) \left( e^2 + E^2 \right) - \nu^2
    = E^2 - e^2 - \nu^2
    = 0
    \\
    & \; \implies E_{\pm} = \pm \sqrt{ e^2 + \nu^2 }.
    \\
\end{align*}

Závislost $E_{\pm}$ na $\nu$ je potom:
\begin{figure}[h!]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions={color size 12cm, 5cm}]
        E(nu) = sqrt(1 + nu**2)

        set xlabel "$\\frac{\\nu}{e}$"
        set ylabel "$\\frac{E_{\\pm}}{e}$" rotate by 0

        set key center top

        set xrange [-5:5]
        set yrange [-5:5]

        plot E(x) title "$E_{+}$", -E(x) title "$E_{-}$"
    \end{gnuplot}
\end{figure}

\bigskip

Pokračujeme vypočtením odpovídajících vlastních vektorů:
\begin{align*}
    \ker\left( \hat H - E_{+} \, \hat 1 \right)
    = \ker\mat{ e - E_{+} & \nu }
    \ni \frac{1}{\sqrt{\nu^2 + (E_{+} - e)^2}} \mat{ \nu \\ E_{+}-e } = \ket{E_{+}},
    \\[5pt]
    \ker\left( \hat H + E_{+} \, \hat 1 \right)
    = \ker\mat{ e + E_{+} & \nu }
    \ni \frac{1}{\sqrt{\nu^2 + (E_{+} + e)^2}} \mat{ -\nu \\ E_{+}+e } = \ket{E_{-}}.
\end{align*}

Nakonec vypočteme vlastní vektory pro $\nu=0$ a $\nu\to\infty$. Při $\nu=0$ je $\hat H = \hat H_0$ a vlastní vektory známe přímo ze zadání. Případ $\nu\to\infty$ vyšetříme pomocí limity.
\begin{align*}
    &\ket{E_{+}(\nu = 0)} = \mat{1 \\ 0}, &
    &\ket{E_{-}(\nu = 0)} = \mat{0 \\ 1},
\end{align*}
\begin{align*}
    &\ket{E_{\pm}(\nu=0)}
    = \lim_{\nu\to\infty} \frac{1}{\sqrt{\nu^2 + (E_{+} \mp e)^2}} \mat{ \pm \nu \\ E_{+} \mp e }
    = \frac{1}{\sqrt{2}} \mat{\pm 1 \\ 1}.
\end{align*}


\subsection{Zadání druhé části}
Mějme $N$-stavový systém s tridiagonálním Hamiltoniánem:
\begin{align*}
    \hat H = \mat{
        e   & \nu & \vph{\ddots} \\
        \nu & e   & \nu & \vph{\ddots} \\
            & \nu & e   & \nu & \vph{\ddots} \\
            &     & \nu & e   & \ddots \\
            &     &     & \ddots & \ddots
    }.
\end{align*}
Určete jeho vlastní hodnoty a normalizované vlastní vektory. Jak se bude měnit spektrum s rostoucím $N$?

\subsection{První pokus o řešení druhé části}
Úlohu jsem se nejprve pokoušel vyřešit tak, že vyjádřím determinant tridiagonální matice v uzavřené formě. Tento postup mě sice dovedl k charakteristické rovnici Hamiltoniánu v uzavřené formě, nepodařilo se mi ji ale vyřešit pro obecné $N$. Postup zde přesto nechávám pro zajímavost.

\bigskip

Z důvodů, které budou hned zřejmé, si zadefinujeme matice $A_N, B_N \in \mathbb{C}^{N \times N}$ lišící se pouze v prvním sloupci:
\begin{align*}
    &A_N =
    \underbrace{
        \mat{
            a & b & \vph{\ddots} \\
            b & a & b & \vph{\ddots} \\
                & b & a   & \ddots \\
            \ph{\ddots} &     & \ddots & \ddots
        }
    }_{N \text{ sloupců}},
    &
    &B_N =
    \underbrace{
        \mat{
            b & b & \vph{\ddots} \\
            0 & a & b & \vph{\ddots} \\
                & b & a   & \ddots \\
            \ph{\ddots} &     & \ddots & \ddots
        }
    }_{N \text{ sloupců}}.
\end{align*}

Nyní si pomocí minorů vyjádříme jejich determinanty:

\begin{align*}
    &\det
    \mat{
        a & b & \vph{\ddots} \\
        b & a & b & \vph{\ddots} \\
          & b & a & b & \vph{\ddots} \\
          &   & b & a   & \ddots \\
        \ph{\ddots} & \ph{\ddots} & \ph{\ddots} & \ddots & \ddots
    }
    =
    a \det
    \mata{c|cccc}{
          &   & \vph{\ddots} \\\hline
          & a & b & \vph{\ddots} \\
          & b & a & b & \vph{\ddots} \\
          &   & b & a   & \ddots \\
        \ph{\ddots} & \ph{\ddots} & \ph{\ddots} & \ddots & \ddots
    }
    -
    b \det
    \mata{c|c|ccc}{
          &   & \vph{\ddots} \\\hline
        b &   & b & \vph{\ddots} \\
          &   & a & b & \vph{\ddots} \\
          &   & b & a   & \ddots \\
        \ph{\ddots} & \ph{\ddots} & \ph{\ddots} & \ddots & \ddots
    },
    \\[10pt]
    &\det
    \mat{
        b & b & \vph{\ddots} \\
        0 & a & b & \vph{\ddots} \\
          & b & a & b & \vph{\ddots} \\
          &   & b & a   & \ddots \\
        \ph{\ddots} & \ph{\ddots} & \ph{\ddots} & \ddots & \ddots
    }
    =
    b \det
    \mata{c|cccc}{
          &   & \vph{\ddots} \\\hline
          & a & b & \vph{\ddots} \\
          & b & a & b & \vph{\ddots} \\
          &   & b & a   & \ddots \\
        \ph{\ddots} & \ph{\ddots} & \ph{\ddots} & \ddots & \ddots
    }.
    \\
\end{align*}
Totéž zapsáno v kompaktní formě:
\begin{align*}
    &\det A_N = a \det A_{N-1} - b \det B_{N-1}, \\
    &\det B_N = b \det A_{N-1}.
    \\[5pt]
    \implies &\det A_N = a \det A_{N-1} - b^2 \det A_{N-2}.
\end{align*}
Navíc vidíme, že platí:
\begin{align*}
    &\det A_1 = a, \\
    &\det A_2 = a^2 - b^2.
\end{align*}

Vyřešíme tedy diferenční rovnici. Charakteristický polynom rekurence\footnote{Hlubší teorii k řešení diferenčních rovnic lze nalézt například na \url{https://en.wikipedia.org/wiki/Constant-recursive_sequence}} je:
\begin{align*}
    p(t) = t^2 - at + b^2,
\end{align*}
a jeho kořeny jsou
\begin{align*}
    &t_{+} = \frac{a}{2} + \sqrt{ \left( \frac{a}{2} \right)^2 - b^2 \; }, \\
    &t_{-} = \frac{a}{2} - \sqrt{ \left( \frac{a}{2} \right)^2 - b^2 \; }.
\end{align*}
Hledáme tedy řešení ve tvaru
\begin{align*}
    \det A_n = c \, t_{+}^n + d \, t_{-}^n,
\end{align*}
dosazením známých hodnot $A_1$ a $A_2$ získáme hodnoty konstant. Po zjednodušení výrazu dostáváme pro determinant matice $A_N$ vztah:
\begin{align*}
    \det A_{N} = \frac{1}{2^{N+1} \sqrt{a^{2} - 4 b^{2}}} \left( \left(a + \sqrt{a^{2} - 4 b^{2}}\right)^{N + 1} - \left(a - \sqrt{a^{2} - 4 b^{2}}\right)^{N + 1} \right).
\end{align*}

Nyní platí $\det\left( \hat H - \lambda \hat 1 \right) = \det A_n$ pro $a = e - \lambda, b = \nu$. Charakteristický polynom Hamiltoniánu je tedy:
\begin{align*}
    p(\lambda) =
    \frac{1}{2^{N+1} \sqrt{-4\nu^{2} + \left(e-\lambda\right)^{2}}}
    \left(
        \left(e - \lambda + \sqrt{- 4 \nu^{2} + \left(e - \lambda\right)^{2}}\right)^{N + 1}
        -
        \left(e - \lambda - \sqrt{- 4 \nu^{2} + \left(e - \lambda\right)^{2}}\right)^{N + 1}
    \right).
\end{align*}

Pomocí CAS je snadné najít řešení pro několik prvních $N\in\{1, 2, 3, \dots\}$:
\begin{table}[h!]
    \centering
    \begin{tabular}{ c|c }
        $\bm{p(\lambda)=0}$ &
        $\bm{\lambda}$ \\
        \hline
        $\bm{N=1}$ &
        $e$
        $\vph{\ddots}$ \\
        \hline
        $\bm{N=2}$ &
        $e - \nu, \; e + \nu$
        $\vph{\ddots}$ \\
        \hline
        $\bm{N=3}$ &
        $e, \; e - \sqrt{2} \nu, \; e + \sqrt{2} \nu$
        $\vph{\ddots}$ \\
        \hline
        $\bm{N=4}$ &
        $e + \frac{-1 + \sqrt{5}}{2}\nu, \;
        e  + \frac{+1 + \sqrt{5}}{2}\nu, \;
        e  + \frac{-1 - \sqrt{5}}{2}\nu, \;
        e  + \frac{+1 - \sqrt{5}}{2}\nu$
        $\vph{\ddots}$
    \end{tabular}
\end{table}

Přestože řešení vypadají pravidelně, nepodařilo se mi najít vztah udávající řešení pro obecné $N$.

\subsection{Druhý pokus o řešení druhé části}
Vyjádříme-li si charakteristickou rovnici pro Hamiltonián, dostaneme:
\begin{gather*}
    \hat H \vec u = \lambda \vec u,
    \\[10pt]
    \mat{
        e   & \nu & \vph{\ddots} \\
        \nu & e   & \nu  & \vph{\ddots} \\
            & \nu & e    & \ddots \\
        \ph{\ddots} &     & \ddots & \ddots
    }
    \mat{
        \bm{u}^1 \vph{\ddots} \\
        \bm{u}^2 \vph{\ddots} \\
        \bm{u}^3 \vph{\ddots} \\
        \vdots \vph{\ddots}
    }
    =
    \mat{
        \lambda \bm{u}^1 \vph{\ddots} \\
        \lambda \bm{u}^2 \vph{\ddots} \\
        \lambda \bm{u}^3 \vph{\ddots} \\
        \vdots \vph{\ddots}
    },
    \\[10pt]
    \mat{
        e \bm{u}^1 + \nu \bm{u}^2 \vph{\ddots} \\
        \nu \bm{u}^1 + e \bm{u}^2 + \nu \bm{u}^3 \vph{\ddots} \\
        \nu \bm{u}^2 + e \bm{u}^3 + \nu \bm{u}^4 \vph{\ddots} \\
        \vdots \vph{\ddots}
    }
    =
    \mat{
        \lambda \bm{u}^1 \vph{\ddots} \\
        \lambda \bm{u}^2 \vph{\ddots} \\
        \lambda \bm{u}^3 \vph{\ddots} \\
        \vdots \vph{\ddots}
    }.
\end{gather*}

Dostáváme tedy $N$-tici rovnic o $N$ neznámých:
\begin{align*}
    \lambda \bm{u}^1 &= e \bm{u}^1 + \nu \bm{u}^2 \\
    \lambda \bm{u}^2 &= \nu \bm{u}^1 + e \bm{u}^2 + \nu \bm{u}^3 \\
    &\vdots \\
    \lambda \bm{u}^j &= \nu \bm{u}^{j-1} + e \bm{u}^j + \nu \bm{u}^{j+1} \\
    &\vdots \\
    \lambda \bm{u}^{N-1} &= \nu \bm{u}^{N-2} + e \bm{u}^{N-1} + \nu \bm{u}^N \\
    \lambda \bm{u}^N &= \nu \bm{u}^{N-1} + e \bm{u}^N
\end{align*}

Všimneme si, že okrajové podmínky lze zjednodušit doplněním smyšlené nulté a $(N+1)$. složky vlastního vektoru, dostáváme tak diferenční úlohu:
\begin{gather*}
    \lambda \bm{u}^j = \nu \bm{u}^{j-1} + e \bm{u}^j + \nu \bm{u}^{j+1}, \\
    \bm{u}^0 = 0, \;\;\; \bm{u}^{N+1} = 0.
\end{gather*}

Z nápovědy víme, že máme řešení hledat pomocí násady\footnote{Násada, v cizojazyčné literatuře „ansatz“, je odhad tvaru řešení. Typicky omezuje možná řešení na užší rodinu – nemusí tedy nutně vést k nalezení všech řešení, výrazně ale usnadňuje jejich hledání. V našem případě vede použití násady k nalezení $N$ řešení, což je maximální počet vlastních vektorů matice $N\times N$, žádné řešení nám tedy neušlo, stačí pouze zkontrolovat, že jsou to skutečně řešení původní úlohy.}:
\begin{align*}
    \bm{u}^j = c^j,
\end{align*}
na levé straně má horní skript význam $j$-té složky vektoru, na pravé znamená $j$-tou mocninu.

\begin{align*}
    \lambda c^j &= \nu c^{j-1} + e c^j + \nu c^{j+1} \\
    \lambda c &= \nu + e c + \nu c^2 \\
    0 &= \nu c^2 + (e-\lambda) c + \nu \\[10pt]
    c_{\pm} &= \frac{\lambda-e}{2\nu} \pm \sqrt{\left(\frac{\lambda-e}{2\nu}\right)^2 - 1}
\end{align*}
Zajímavou vlastností kořenů je:
\begin{align*}
    c_{+} \, c_{-} &=
    \left(
        \frac{\lambda-e}{2\nu} +
        \sqrt{\left(\frac{\lambda-e}{2\nu}\right)^2 - 1}
    \right)
    \left(
        \frac{\lambda-e}{2\nu} -
        \sqrt{\left(\frac{\lambda-e}{2\nu}\right)^2 - 1}
    \right)
    \\[10pt]
    &=
    \left(\frac{\lambda-e}{2\nu}\right)^2 -
    \left( \left(\frac{\lambda-e}{2\nu}\right)^2 - 1 \right)
    = 1
    \\
\end{align*}

Protože máme dva kořeny, hledáme řešení ve tvaru
\begin{align*}
    \bm{u}^j = A \, {c_{+}}^j + B \, {c_{-}}^j.
\end{align*}
Dosazením do okrajových podmínek získáme:
\begin{equation*}
\begin{array}{rclclcl}
    0 &=& \multicolumn{3}{l}{\bm{u}^0 = A \, c_{+}^{\;\;0} + B \, c_{-}^{\;\;0}} = A+B &\Leftrightarrow& B = -A
    \\[20pt]
    0 &=& \bm{u}^{N+1} &=& A \, c_{+}^{\;\;N+1} + B \, c_{-}^{\;\;N+1}
    \\[10pt]
    & & &=& A \, (c_{+}^{\;\;N+1} - c_{-}^{\;\;N+1})
    &\Leftrightarrow& A = 0 \\[10pt]
    & & & & &\vee& c_{+} = c_{-} = 0 \\[10pt]
    & & & & &\vee& \left(\nicefrac{c_{+}}{c_{-}}\right)^{N+1} = 1
\end{array}
\end{equation*}
Protože vlastní vektor z definice nemůže být nulový, vyřadíme řešení $A=0, \; c_{+} = c_{-} = 0$, zůstává nám tedy
\begin{align*}
    \bm{u}^j = A \, (c_{+}^{\;\;j} - c_{-}^{\;\;j}), \;\;\;
    \left(\nicefrac{c_{+}}{c_{-}}\right)^{N+1} = 1. \\
\end{align*}
\begin{align*}
    &\left(\nicefrac{c_{+}}{c_{-}}\right)^{N+1} = 1 = \e{2k\i\pi}, \;\;\; k\in\mathbb{N},
    \\[10pt]
    &\implies \nicefrac{c_{+}}{c_{-}} = \e{\tfrac{2k}{N+1}\,\i\pi},
    \\[10pt]
    &\implies \left( \nicefrac{c_{+}}{c_{-}} \right) \left( c_{+}\,c_{-} \right) =  \e{\tfrac{2k}{N+1}\, \i\pi},
    \;\;\; \text{(s použitím }c_{+}\,c_{-}=1\text{)}
    \\[10pt]
    &\implies c_{+}^{\;2} = \e{\tfrac{2k}{N+1}\, \i\pi},
    \\[10pt]
    &\implies c_{+} = \pm \, \e{\tfrac{k}{N+1}\, \i\pi},
    \;\;\; (*)
    \\[10pt]
    &\implies c_{+} = \e{\tfrac{k}{N+1}\, \i\pi},
    \;\;\; c_{-} = \e{\tfrac{-k}{N+1}\; \i\pi},
    \\[10pt]
    &\implies \bm{u}^j = A \left( \e{\tfrac{jk}{N+1}\, \i\pi} - \e{\tfrac{-jk}{N+1}\, \i\pi} \right),
    \;\;\; k \in \left\{ 1, 2, \, ... \; N \right\}.
\end{align*}
\begin{spacing}{1.9}
\noindent
Kde v $(*)$ jsme využili skutečnosti, že řešení ${c_{+} = - \, \e{\tfrac{k}{N+1}\, \i\pi},} \;\; {c_{-} =  - \, \e{\tfrac{-k}{N+1}\, \i\pi}}$ je stejné, jako řešení ${c_{-} = + \, \e{\tfrac{-(N+1-k)}{N+1} \, \i\pi}}$, ${c_{+} = +\, \e{\tfrac{N+1-k}{N+1} \, \i\pi}}$, můžeme tedy přestat psát $\pm$. Na posledním řádku jsme vyřadili řešení $k=0$ a $k=N+1$ – v nich $c_{+}$ a $c_{-}$ splývají, vlastní vektor by tedy vyšel nulový.
\end{spacing}

Podařilo se nám najít $N$ vlastních vektorů $\vec{u}_k$, díky násadě i bez ohledu na konkrétní hodnoty $e, \nu, \lambda$. Můžeme si tedy nyní vyjádřit vlastní hodnoty jako funkce $\lambda(e, \nu, k)$. Nejprve ale zjednodušíme a normalizujeme vektor $\vec{u}$:
\begin{align*}
    &\bm{u}^j = A \left( \e{\tfrac{jk}{N+1}\, \i\pi} - \e{\tfrac{-jk}{N+1}\, \i\pi} \right),
    \\[10pt]
    &\implies \bm{u}^j = 2 \i A \sin \left( \frac{jk\pi}{N+1} \right),
    \\[10pt]
    &\implies \bm{u}^j = C \sin \left( \frac{jk\pi}{N+1} \right).
    \\
\end{align*}
\begin{align*}
    &1 = \norm{ \vec{u} },
    \\[10pt]
    &\implies 1 = \sum_{j=1}^N \left(\bm{u}^j\right)^2,
    \\[10pt]
    &\implies 1 = \sum_{j=1}^N C^2 \sin^2 \left( \frac{jk\pi}{N+1} \right),
    \\[10pt]
    &\implies C = \left( \sum_{j=1}^N \sin^2 \left( \frac{jk\pi}{N+1} \right) \right)^{-\,\nicefrac{1}{2}},
    \\[10pt]
    &\implies C = 2  \left(
        -\sin \left( \frac{ 2N + 1 }{N + 1} \; k \pi \right) \csc \left( \frac{ k \pi }{N + 1} \right) + 2N + 1
    \right)^{-\,\nicefrac{1}{2}}.
\end{align*}
Poslední krok byl navržen programem Wolfram Mathematica a numericky zkontrolován pro $N \in \left\{ 1, \, ... \; 15 \right\}$, $\csc$~je~kosekans, platí pro něj $\csc \varphi = \frac{1}{\sin \varphi}$. Normalizační konstanta ovšem není příliš důležitá, v praxi můžeme vždy normalizovat stavový vektor numericky.

Pojďme nyní vyjádřit $\lambda$. Začneme charakteristickou rovnicí pro první souřadnici:
\begin{align*}
    \lambda \bm{u}^1 &= e \bm{u}^1 + \nu \bm{u}^2,
    \\[10pt]
    \left( \lambda - e \right) \bm{u}^1 &= \nu \bm{u}^2,
    \\[10pt]
    \frac{\lambda - e}{\nu} &= \frac{\bm{u}^2}{\bm{u}^1}
    = \frac{ \sin\left(\frac{2k \pi}{N+1}\right) }{ \sin\left(\frac{k \pi}{N+1}\right) }
    = 2 \cos\left( \frac{k\pi}{N+1} \right),
    \\[10pt]
    \lambda &= e + 2\nu \cos\left( \frac{k\pi}{N+1} \right).
\end{align*}
Mohli jsme dělit $\bm{u}^1$, pro povolené hodnoty $k$ nikdy není nulové. Protože vlastní číslo Hamiltoniánu odpovídá energetické hladině, máme pro energii $k$-tého stavu vztah:
\begin{align*}
    E_k = e + 2 \nu \cos\left(\frac{k\pi}{N+1}\right).
\end{align*}

Nakonec by bylo vhodné zkontrolovat, zda násada $\bm{u}^j = c^j$ skutečně vedla na správné řešení a nalezená $\vec{u}, \lambda$ splňují charakteristickou rovnici:
\begin{align*}
    \lambda \bm{u}^j &= \nu \bm{u}^{j-1} + e \bm{u}^j + \nu \bm{u}^{j+1},
    \\[10pt]
    0 &= \nu \bm{u}^{j-1} - 2\nu \cos\left(\frac{k\pi}{N+1}\right) \bm{u}^j + \nu \bm{u}^{j+1},
    \\[10pt]
    0 &= \sin\left( \frac{(j-1)k\pi}{N+1} \right) + \sin\left( \frac{(j+1)k\pi}{N+1} \right) - 2 \cos\left(\frac{k\pi}{N+1}\right)\sin\left( \frac{jk\pi}{N+1} \right).
\end{align*}
Tato rovnost je zřejmá ze vzorce $\sin(a+b) = \cos(a)\sin(b) + \sin(a)\cos(b)$, nalezená řešení jsou tedy platná.

\subsection{Výsledek druhé části}
Zadaný Hamiltonián má vázané stavy $k \in \left\{ 1, \, ... \; N \right\}$, jim odpovídající vlastní vektory jsou:
\begin{align*}
    \ket{k} &= C \; \mat{
        \sin\left( \nicefrac{k\pi}{N+1} \right) \\
        \sin\left( \nicefrac{2k\pi}{N+1} \right) \\
        \vdots \\
        \sin\left( \nicefrac{Nk\pi}{N+1} \right)
    },
    &
    \text{kde } \;\;
    C &= 2  \left(
        -\sin \left( \frac{ 2N + 1 }{N + 1} \; k \pi \right) \csc \left( \frac{ k \pi }{N + 1} \right) + 2N + 1
    \right)^{-\,\nicefrac{1}{2}}.
\end{align*}
Energie $k$-tého stavu je:
\begin{align*}
    E_k = e + 2 \nu \cos\left(\frac{k\pi}{N+1}\right).
\end{align*}
V grafu je vidět zhušťování energetických hladiny s rostoucím $N$:
\begin{figure}[h!]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions={color size 12cm, 4.5cm}]

        chi(x, N) = x >= N-0.5 ? x <= N+0.5 ? 1 : 1/0 : 1/0
        E(x, k, N) = 2 * cos(k*pi/(N+1)) * chi(x, N)

        set macros

        set xlabel "$N$"
        set ylabel "$E_k$" rotate by 0

        set key center top

        set xrange [0:11]
        set yrange [-2:2]

        set ytics ("$e-2\\nu$" -2, "$e-\\nu$" -1, "$e$" 0, "$e+\\nu$" 1, "$e+2\\nu$" 2)

        nt = "notitle lt rgb 'red'"
        plt = ""

        do for [N=1:11] {
            do for [k=1:N] {
                plt = plt."E(x,".k.",".N.") ".nt.", "
            }
        }

        plot @plt
    \end{gnuplot}
\end{figure}

\noindent Pro $N\to\infty$ je energetické spektrum spojité a energie stavů se pohybují mezi $e-2\nu$ a $e+2\nu$.




\pagebreak

\section{Cvičení 29. 10.}

\subsection{Harmonický oscilátor}
Máme zadaný Hamiltonián jednorozměrného harmonického oscilátoru:
\begin{gather*}
    \hat{H} = \frac{1}{2M} \; \hat{p}^2 + \frac{1}{2} M \Omega^2 \; \hat{x}^2,
    \;\;\;\;\;\;
    \comm{\hat{x}}{\hat{p}} = \i \hbar.
\end{gather*}
Tentýž Hamiltonián lze vyjádřit pomocí posunovacích\footnote{V anglické literatuře se posunovací operátory nazývají „ladder operators“.} operátorů $\hat{a}, \hat{a}^\dagger$:
\begin{gather*}
    \hat{H} = \hbar \Omega \left(
        \hat{a}^\dagger \hat{a} + \frac{1}{2}
    \right),
    \;\;\;\;\;\;
    \comm{\hat{a}}{\hat{a}^\dagger} = 1,
    \\[5pt]
    \hat{x} = \sqrt{\hbar / 2 M \Omega}
    \left( \hat{a}^\dagger + \hat{a} \right),
    \;\;\;\;\;\;
    \hat{p} = \i \sqrt{\hbar M \Omega / 2}
    \left( \hat{a}^\dagger - \hat{a} \right).
\end{gather*}
Ze cvičení víme, že platí:
\begin{align*}
    &\hat{n} = \hat{a}^\dagger \hat{a},
    \\
    &\hat{n} \ket{n} = n \ket{n}, \; n \in \mathbb{N}_0,
    \\
    &\hat{a} \hph{\vph{\hat{a}}^\dagger} \ket{n} = \hph{\vph{n}+1} \sqrt{n} \ket{n-1},
    \\
    &\hat{a}^\dagger \ket{n} = \sqrt{n+1} \ket{n+1}.
\end{align*}

Vypočteme maticové elementy $\hat{x}^2$:
\begin{align*}
    \bra{m} \hat{x}^2 \ket{n}
    &= \bra{m} \left(
        \sqrt{\hbar / 2 M \Omega}
        \left( \hat{a}^\dagger + \hat{a} \right)
    \right)^2 \ket{n}
    \\[5pt]
    &= \frac{\hbar}{2 M \Omega} \; \bra{m} \left(
        \hat{a}^{\dagger 2} + \hat{a}^\dagger \hat{a} + \hat{a} \hat{a}^\dagger + \hat{a}^2
    \right) \ket{n}
    \\[5pt]
    &= \frac{\hbar}{2 M \Omega} \; \bra{m} \left(
        \hat{a}^{\dagger 2} + 2\hat{n} + \hat{1} + \hat{a}^2
    \right) \ket{n}
    \\[5pt]
    &= \frac{\hbar}{2 M \Omega} \; \bra{m} \left(
        \sqrt{n+1}\sqrt{n+2}\ket{n+2} + 2n\ket{n} + \ket{n} + \sqrt{n}\sqrt{n-1}\ket{n-2}
    \right)
    \\[5pt]
    &= \frac{\hbar}{2 M \Omega} \; \left(
        \sqrt{(n+1)(n+2)} \braket{m}{n+2} +
        (2n+1) \braket{m}{n} +
        \sqrt{n(n-1)} \braket{m}{n-2}
    \right).
\end{align*}
Vidíme, že nenulové budou pouze členy na diagonále, dva řádky nad diagonálou a dva řádky pod diagonálou.

Než se pustíme do výpočtu maticových elementů $\hat{x}^4$, nejprve roznásobíme výraz $(\hat{a}^\dagger + \hat{a})^4$:
\begin{align*}
    \left( \hat{a}^\dagger + \hat{a} \right)^4
    &= \left( \hat{a}^\dagger + \hat{a} \right)^2 \left( \hat{a}^\dagger + \hat{a} \right)^2
    \\[5pt]
    &= \left( \hat{a}^{\dagger 2} + 2 \hat{a}^\dagger \hat{a} + \hat{a}^2+ \hat{1} \right) \left( \hat{a}^{\dagger 2} + 2 \hat{a}^\dagger \hat{a} + \hat{a}^2+ \hat{1} \right)
    \\[5pt]
    &= \hat{a}^{\dagger 4} + \hat{a}^4 + 2\hat{a}^{\dagger 2} + 2\hat{a}^2 + 4\hat{n}^2 + 4\hat{n} \\
    &\,+ 2\hat{a}^{\dagger 2} \hat{n} + 2\hat{n} \hat{a}^{\dagger 2} + 2\hat{a}^2 \hat{n} + 2\hat{n} \hat{a}^2 \\
    &\,+ \hat{a}^{\dagger 2} \hat{a}^2 + \hat{a}^2 \hat{a}^{\dagger 2} + \hat{1}
    \\[5pt]
    &= \hat{a}^{\dagger 4} + \hat{a}^4 + 6\hat{a}^{\dagger 2} - 2\hat{a}^2 + 6\hat{n}^2 + 6\hat{n} + 4\hat{a}^{\dagger 2} \hat{n} + 4\hat{a}^2 \hat{n} + \hat{3}
\end{align*}
Nyní snadno dopočteme maticové elementy $\hat{x}^4$:
\begin{align*}
    \bra{m} \hat{x}^4 \ket{n}
    &= \left( \frac{\hbar}{2 M \Omega} \right)^2 \sqrt{\frac{\left(n + 4\right)!}{n!}} \braket{m}{n + 4 } \\[5pt]
    &+ \left( \frac{\hbar}{2 M \Omega} \right)^2 \sqrt{\frac{\left(n + 2\right)!}{n!}} \left(4 n + 6\right) \braket{m}{n + 2} \\[5pt]
    &+ \left( \frac{\hbar}{2 M \Omega} \right)^2 \left(6 n^{2} + 6 n + 3\right) \braket{m}{n} \\[5pt]
    &+ \left( \frac{\hbar}{2 M \Omega} \right)^2 \sqrt{\frac{n!}{\left(n - 2\right)!}} \left(4 n - 2\right) \braket{m}{n - 2} \\[5pt]
    &+ \left( \frac{\hbar}{2 M \Omega} \right)^2 \sqrt{\frac{n!}{\left(n - 4\right)!}} \braket{m}{n - 4}.
\end{align*}
Ve vyjádření $\bra{m} \hat{x}^4 \ket{n}$ byla použita konvence $0\cdot\infty = 0, \;\;\; n<0 \implies \ket{n} = 0$, roznásobením faktoriálů je možné dostat méně kompaktní, korektnější vyjádření.

\subsection{Kvadratický oscilátor}
Máme Hamiltonián odpovídající kvadratickému oscilátoru:
\begin{align*}
    \hat{H} = \frac{1}{2M} \hat{p}^2 + \frac{1}{2} M \Omega^2 \hat{x}^2 + \frac{1}{2} b \hat{x}^4.
\end{align*}
Chceme-li vypočítat vlastní čísla Hamiltoniánu, budeme to muset udělat numericky. Je výhodné použít maticové vyjádření $\hat{H}$ pomocí vlastních vektorů \textit{harmonického} oscilátoru ($\ket{n}$ v předchozí úloze). Tím nám vznikne řídká matice\footnote{Angl. „sparse matrix“}, kterou lze rychle diagonalizovat.
Už jsme vypočetli maticové vyjádření $\hat{x}^2, \hat{x}^4$, úplně stejným způsobem je možné dostat maticové vyjádření $\hat{p}^2$:
\begin{align*}
    \bra{m} \hat{p}^2 \ket{n}
    &= \frac{1}{2} \i \hbar M \Omega \bra{m} \left(
        \hat{a}^{\dagger 2} - 2\hat{n} - \hat{1} + \hat{a}^2
    \right) \ket{n}
    \\[5pt]
    &= \frac{1}{2} \i \hbar M \Omega \left(
        \sqrt{(n+1)(n+2)} \braket{m}{n+2}
        -(2n+1)\braket{m}{n}
        +\sqrt{n(n-1)} \braket{m}{n-2}
    \right)
\end{align*}
Pro maticové vyjádření Hamiltoniánu tedy platí:
\begin{align*}
    H_{mn} &= \bra{m} \hat{H} \ket{n} \\
    &= \frac{\hbar}{8 M^{2} \Omega^{2}} \left(
        \begin{array}{l}
            4 M^{2} \Omega^{3} \left(2 n + 1\right) \left\langle m \right. {\left|n\right\rangle } + 4 b \hbar n^{\frac{3}{2}} \sqrt{n - 1} \left\langle m \right. {\left|n - 2\right\rangle } + b \hbar \sqrt{n} \sqrt{n - 3} \sqrt{n - 2} \sqrt{n - 1} \left\langle m \right. {\left|n - 4\right\rangle }
            \\
            - 2 b \hbar \sqrt{n} \sqrt{n - 1} \left\langle m \right. {\left|n - 2\right\rangle } + 6 b \hbar n^{2} \left\langle m \right. {\left|n\right\rangle } + 4 b \hbar n \sqrt{n^{2} + 3 n + 2} \left\langle m \right. {\left|n + 2\right\rangle } + 6 b \hbar n \left\langle m \right. {\left|n\right\rangle }
            \\
            + 6 b \hbar \sqrt{n^{2} + 3 n + 2} \left\langle m \right. {\left|n + 2\right\rangle } + b \hbar \sqrt{n^{4} + 10 n^{3} + 35 n^{2} + 50 n + 24} \left\langle m \right. {\left|n + 4\right\rangle } + 3 b \hbar \left\langle m \right. {\left|n\right\rangle }
        \end{array}
    \right).
\end{align*}

Ze zadání jsem dosadil $M = \Omega = \hbar = b = 1$. Pomocí tohoto vzorce jsem vygeneroval matici $N \times N$ a numericky ji diagonalizoval pomocí knihovny \textit{mpmath}. Vývoj prvních čtyř energetických hladin (základní $E_0$ a tři excitované $E_{1,2,3}$) v závislosti na $N$ je vidět v následujícím grafu.

\begin{gnuplot}[terminal=epslatex,terminaloptions={color size 18cm, 7cm}]
    F = '3b_eigvals.dat'
    set xlabel '$N$'
    set ylabel '$E$'
    plot F using 1:2 t '$E_0$', F using 1:3 t '$E_1$', F using 1:4 t '$E_2$', F using 1:5 t '$E_3$'
\end{gnuplot}


Je vidět, že energie konvergují rychle. Lépe rychlost konvergence uvidíme v grafu závislosti $\Delta E(N)$, tedy změny $E$ při zvýšení $N$ o jedna.

\begin{gnuplot}[terminal=epslatex,terminaloptions={color size 18cm, 7cm}]
    F = '3b_eigdiff.dat'
    set xlabel '$N$'
    set ylabel '$\Delta E$'
    set logscale y 10
    set yrange [1e-10:1]
    plot F using 1:2 t '$E_0$', F using 1:3 t '$E_1$', F using 1:4 t '$E_2$', F using 1:5 t '$E_3$', 1e-4 lc rgb 'grey' notitle, 1e-5 lc rgb 'red' notitle, 1e-6 lc rgb 'grey' notitle
\end{gnuplot}

Vidíme, že pro $N=30$ jsou již změny spolehlivě menší než řádu $10^{-5}$ (tudíž pod červenou čárou), pro $N=35$ jsou potom menší než $10^{6}$. Podrobnější analýza ukazuje, že pro určení prvních čtyř energií na pět platných cifer stačí $N=23$. Použitá přesnost knihovny \textit{mpmath} byla řádově vyšší, zaokrouhlovací chyby a numerická stabilita použitého diagonalizačního algoritmu by tedy neměly mít vliv. Vypočtené hodnoty energetických hladin byly:
\begin{table}[h!]
    \centering
    \begin{tabular}{ c|c|c|c }
        $E_0$ & $E_1$ & $E_2$ & $E_3$
        \\\hline
        \csvreader[ head to column names ]{3b_eigvals.csv}{}
        {
            \ea & \eb & \ec & \ed
        }
    \end{tabular}
\end{table}

% nakoupit: kuskus, pomazánky, nealko, víno, piva, ovoce, křupky


\subsection{Dvoujámový potenciál}
Máme zadaný Hamiltonián:
\begin{align*}
    \hat{H} = \frac{1}{2M} \hat{p}^2 - \frac{1}{2} a \hat{x}^2 + \frac{1}{2} b \hat{x}^4
\end{align*}
Potenciál má tři stacionární body – dvě globální minima a jedno lokální maximum:
\begin{align*}
    0 &= \dd{}{x} \left(-\frac{1}{2} a x^2 + \frac{1}{2} b x^4\right)
    \\[10pt]
    0 &= -ax + 2b^3
    \\[10pt]
    0 &= x \left( x + \sqrt{\frac{a}{2b}} \right) \left( x - \sqrt{\frac{a}{2b} }\right)
\end{align*}
Máme vyšetřit energetické hladiny pro $\hbar = 0.03$, $M=\Omega=a=b=1$. Pro porovnání přikládám graf s $a\in\{0,1,2\}$:

\begin{gnuplot}[terminal=epslatex,terminaloptions={color size 18cm, 7cm}]
    V(x,a,b) = -0.5 * a * x**2 + 0.5 * b * x**4

    set xlabel "$x$"
    set ylabel "$V$"

    set xrange [-1.5:1.5]
    set yrange [-0.3:0.5]

    plot V(x,0,1) t "$a=0$" lc rgb "orange", V(x,1,1) t "$a=1$" lc rgb "red", V(x,2,1) t "$a=2$" lc rgb "green"
\end{gnuplot}

Použijeme opět maticové vyjádření v diagonální bázi harmonického oscilátoru. Maticová reprezentace Hamiltoniánu po dosazení $M=\Omega=b=1$ je:
\begin{align*}
    \bra{m} \hat{H} \ket{n} &=
    \frac{\hbar^{2}}{8} \sqrt{n(n - 1)(n - 2)(n - 3)} \left\langle m \right. {\left|n - 4\right\rangle }
    \\[5pt] &+
    \frac{\hbar^{2}}{8} \sqrt{(n + 1)(n + 2)(n + 3)(n + 4)} \left\langle m \right. {\left|n + 4\right\rangle }
    \\[5pt] &+
    \frac{\hbar}{4} \sqrt{n(n - 1)} \left(2 \hbar n - \hbar - a - 1\right) \left\langle m \right. {\left|n - 2\right\rangle }
    \\[5pt] &+
    \frac{\hbar}{4} \sqrt{(n+1)(n+2)} \left(2 \hbar n + 3 \hbar - a - 1\right) \left\langle m \right. {\left|n + 2\right\rangle }
    \\[5pt] &+
    \frac{\hbar}{8} \left(- 4 a n - 2 a + 6 \hbar n^{2} + 6 \hbar n + 3 \hbar + 4 n + 2\right) \left\langle m \right. {\left|n\right\rangle }.
\end{align*}

Pro $\hbar = 0.03$ jsou první čtyři energetické hladiny:
\begin{table}[h!]
    \centering
    \begin{tabular}{ c|c|c|c }
        $E_0$ & $E_1$ & $E_2$ & $E_3$
        \\\hline
        \csvreader[ head to column names ]{3c_eigvals.csv}{}
        {
            \ea & \eb & \ec & \ed
        }
    \end{tabular}
\end{table}

Z vypočtených hodnot je vidět, že se energetické stavy vyskytují v dubletech. Lze to vysvětlit pomocí vlnové funkce v $x$-reprezentaci\footnote{Pro podrobnější vysvětlení viz \url{http://www2.chem.umd.edu/groups/alexander/chem691/double_well.pdf}}. Vlnové funkce stavů $E_0, E_1$ jsou totiž (anti)symetrickými superpozicemi vlnových funkcí $\psi_l, \psi_r$, které by odpovídaly částici v levém, resp. pravém údolí potenciálu. Takové superpozice jsou dvě:
\begin{align*}
    \psi_{\pm}(x) = C_N \left( \psi_l(x) \pm \psi_r(x) \right).
\end{align*}
Hamiltonián v $x$-reprezentaci obsahuje kladný člen $\dd{\vph{d}^2}{x^2}$, a protože antisymetrické řešení $\psi_{-}$ má o trochu větší druhou derivaci než symetrické řešení $\psi_{+}$, bude mít i o trochu větší energii.

V grafu na obrázku č. \ref{graph_E_hbar} je vynesená závislost energetických hladin na hodnotě $\hbar$. Vidíme, že pro $\hbar\to\infty$ se energie stavů rozprostřou rovnoměrně, dublety zaniknou. Naopak v klasické limitě $\hbar\to 0$ se energetické stavy vzájemně přibližují a dublety splynou v jeden stav.

Zajímavá je nestejnoměrná konvergence pro $N\to\infty$ v okolí $\hbar = 0$: zatímco pro $\hbar=0.015$ zkonvergují energetické hladiny už při $N \approx 30$, pro $\hbar = 0.002$ už je potřeba matice o straně $N = 160$. Konvergence stavů $E_0, E_2, E_4$ je vynesena v grafu na obrázku č. \ref{graph_hbar_conv}.


\begin{figure}[p]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions={color size 18cm, 10cm}]
        
        palettefile(n) = sprintf("<sed -e 's/set style line/set linetype/' -e 's/lt 1 //' %s.pal", n)
        load palettefile("paired")

        F = "3c_hbar.dat"

        set xlabel "$\\hbar$"
        set ylabel "$E$"
        set xrange [0:.2]

        set key left top

        plot F using 1:2 t "$E_0$" w l, F using 1:3 t "$E_1$" w l, F using 1:4 t "$E_2$" w l, F using 1:5 t "$E_3$" w l, F using 1:6 t "$E_4$" w l, F using 1:7 t "$E_5$" w l, F using 1:8 t "$E_6$" w l, F using 1:9 t "$E_7$" w l, 

    \end{gnuplot}
    \caption{Energetické hladiny v závislosti na $\hbar$.}
    \label{graph_E_hbar}
\end{figure}

\begin{figure}[p]
    \centering
    \begin{gnuplot}[terminal=epslatex,terminaloptions={color size 18cm, 10cm linewidth 2}]

        palettefile(n) = sprintf("<sed -e 's/set style line/set linetype/' -e 's/lt 1 //' %s.pal", n)
        load palettefile("spectral")

        F20 = "3c_hbar_prec20.dat"
        F30 = "3c_hbar_prec30.dat"
        F45 = "3c_hbar_prec45.dat"
        F70 = "3c_hbar_prec70.dat"
        F110 = "3c_hbar_prec110.dat"
        F160 = "3c_hbar_prec160.dat"

        set xlabel "$\\hbar$"
        set ylabel "$E$"
        set yrange [-0.13:0.05]
        set xrange [0:0.03]

        plot F160 using 1:2 t "$N=160$" w l lt 1 lw 2, F160 using 1:4 not w l lt 1 lw 2, F160 using 1:6 not w l lt 1 lw 2, F110 using 1:2 t "$N=110$" w l lt 2 lw 2, F110 using 1:4 not w l lt 2 lw 2, F110 using 1:6 not w l lt 2 lw 2, F70 using 1:2 t "$N=70$" w l lt 3 lw 2, F70 using 1:4 not w l lt 3 lw 2, F70 using 1:6 not w l lt 3 lw 2, F45 using 1:2 t "$N=45$" w l lt 4 lw 2, F45 using 1:4 not w l lt 4 lw 2, F45 using 1:6 not w l lt 4 lw 2, F30 using 1:2 t "$N=30$" w l lt 6 lw 2, F30 using 1:4 not w l lt 6 lw 2, F30 using 1:6 not w l lt 6 lw 2, F20 using 1:2 t "$N=20$" w l lt 8 lw 2, F20 using 1:4 not w l lt 8 lw 2, F20 using 1:6 not w l lt 8 lw 2,

    \end{gnuplot}
    \caption{Konvergence stavů $E_0, E_2, E_4$ v okolí $\hbar=0$.}
    \label{graph_hbar_conv}
\end{figure}


\pagebreak

\section{Cvičení 18. 12.}
\subsection{Zadání}
Máme částici se spinem 1, velikostí magnetického momentu $\mu$, popsanou vlnovou funkcí
\begin{align*}
    \ket{\psi(t)}
    \;=\; \psi_{+}(t) \, \ket{+}
    \;+\; \psi_{0}(t) \, \ket{0}
    \;+\; \psi_{-}(t) \, \ket{-},
\end{align*}
kde $\ket{-}, \ket{0}, \ket{+}$ odpovídají stavům, kdy je projekce spinu na osu $z$ rovná $-1, 0$, resp. $1$.

Částice se pohybuje v magnetickém poli: nejprve je po dobu $\tau$ vystavena poli $B_0+B_1$, poté je po dobu $T$ v poli $B_0$ a nakonec opět po dobu $\tau$ v poli $B_0+B_1$. Platí:
\begin{align*}
    B_0 &= \mat{0 \\ 0 \\ b_0} &
    B_1 &= \mat{
        \ph{-} b_1 \cos \omega t \\
        - b_1 \sin \omega t \\
        0
    }
\end{align*}
Rotace částice generují matice
\begin{align*}
    \const{s}_1 &= \frac{1}{\oldsqrt{2}} \mat{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    },
    &
    \const{s}_2 &= \frac{1}{\oldsqrt{2}} \mat{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    },
    &
    \const{s}_3 &= \mat{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }.
\end{align*}
Vypočtěte\footnote{Povšimněte si, že následující skupina rovnic by mohla klidně posloužit jako přebal nového výtisku básnické sbírky Alkoholy od Guillauma Apollinaira. Pokud znáte nakladatele, který zvažuje tuto sbírku znovu natisknout, nezdráhejte se ho oslovit.}:
\begin{gather*}
    \comm{\const{s}_j}{\const{s}_k} = \?
    \\[10pt]
    {\const{s}_j}^{n+2} = \?
    \\[10pt]
    \mathbf{s}
    \! = \!
    (\const{s}_1, \const{s}_2, \const{s}_3)
    \\[-2pt]
    \exp \, \i \varphi \,
    \hat{n} \cdot \mathbf{s}
    \!\, = \!\, \?
    \\[10pt]
    \omega_{0,1} = 2 \mu \hbar^{-1} b_{0,1}
    \\
    \Omega = \sqrt{(\omega-\omega_0)^2 + \omega_1}
    \\
    \hat{n}_\Omega = \Omega^{-1}
    \mat{ -\omega_1 & 0 & \omega-\omega_0 }^T
    \\
    U(t) =
    \e{\i \omega t \, \const{s}_3}
    \e{-\i \Omega t \, ( \hat{n}_\Omega \cdot \mathbf{s} )}
    \\
    \bra{j} \; U(t) \; \ket{k} = \?
    \\
    \\
\end{gather*}


\subsection{Řešení}
Komutátor je antisymetrická lineární operace, pro tři elementy $\const{s}_1, \const{s}_2, \const{s}_3$ máme tedy tři unikátní komutátory:
\begin{align*}
    \comm{\const{s}_1}{\const{s}_2},
    \;\;\;
    \comm{\const{s}_2}{\const{s}_3},
    \;\;\;
    \comm{\const{s}_3}{\const{s}_1}.
\end{align*}
\begin{gather*}
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    }
    \;
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    }
    -
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    }
    \;
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    }
    =
    \frac{\i}{2} \smat[0.7]{
        1 & 0 & -1 \\
        0 & 0 &  0 \\
        1 & 0 & -1
    }
    -
    \frac{\i}{2} \smat[0.7]{
        -1 & 0 & -1 \\
        0 & 0 & 0 \\
        1 & 0 & 1
    }
    =
    \i \smat[0.7]{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }
    \\
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    }
    \;
    \smat[0.7]{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }
    -
    \smat[0.7]{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }
    \;
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    }
    =
    \frac{\i}{\oldsqrt{2}} \smat[0.7]{
        0 & 0 & 0 \\
        1 & 0 & 1 \\
        0 & 0 & 0
    }
    -
    \frac{\i}{\oldsqrt{2}} \smat[0.7]{
        0 & -1 & 0 \\
        0 &  0 & 0 \\
        0 & -1 & 0
    }
    =
    \frac{\i}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    }
    \\
    \smat[0.7]{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }
    \;
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    }
    -
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        1 & 0 & 1 \\
        0 & 1 & 0
    }
    \;
    \smat[0.7]{
        1 & 0 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & -1
    }
    =
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 1 & 0 \\
        0 & 0 & 0 \\
        0 & -1 & 0
    }
    -
    \frac{1}{\oldsqrt{2}} \smat[0.7]{
        0 & 0 & 0 \\
        1 & 0 & -1 \\
        0 & 0 & 0
    }
    =
    \i \smat[0.7]{
        0 & -\i & 0 \\
        \i & 0 & -\i \\
        0 & \i & 0
    }
\end{gather*}
Zjevně tedy
\begin{align*}
    \comm{\const{s}_j}{\const{s}_k} =
    \i   \; \varepsilon_{jkl} \; \const{s}_l.
\end{align*}

Pokračujeme ověřením cyklické povahy ${\const{s}_j}^2$:
\begin{equation*}
    \def\={\hspace{-5pt}&\hspace{-2pt}=\hspace{-2pt}&\hspace{-5pt}}
    \begin{array}{rcccccccl}
        {\const{s}_1}^3
        \=
        \frac{1}{2} \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \;
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \=
        \frac{1}{2} \smat[0.7]{
            1 & 0 & 1 \\
            0 & 2 & 0 \\
            1 & 0 & 1
        }
        \;
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \=
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \=
        \const{s}_1
        \\
        {\const{s}_2}^3
        \=
        \frac{1}{2} \smat[0.7]{
            0 & -\i & 0 \\
            \i & 0 & -\i \\
            0 & \i & 0
        }
        \smat[0.7]{
            0 & -\i & 0 \\
            \i & 0 & -\i \\
            0 & \i & 0
        }
        \;
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & -\i & 0 \\
            \i & 0 & -\i \\
            0 & \i & 0
        }
        \=
        \frac{1}{2} \smat[0.7]{
            1 & 0 & -1 \\
            0 & 2 & 0 \\
            -1 & 0 & 1
        }
        \;
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & -\i & 0 \\
            \i & 0 & -\i \\
            0 & \i & 0
        }
        \=
        \frac{1}{\oldsqrt{2}} \smat[0.7]{
            0 & 1 & 0 \\
            1 & 0 & 1 \\
            0 & 1 & 0
        }
        \=
        \const{s}_2
        \\
        {\const{s}_3}^3
        \=
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & -1
        }
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & -1
        }
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & -1
        }
        \=
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & 1
        }
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & -1
        }
        \=
        \smat[0.7]{
            1 & 0 & 0 \\
            0 & 0 & 0 \\
            0 & 0 & -1
        }
        \=
        \const{s}_3
        \\
    \end{array}
\end{equation*}
\begin{equation*}
    \left( \hat{n} \cdot \mathbf{s} \right)^3
    =
    \smat[0.7]{
        n_3 & \frac{n_1 - \i n_2}{\sqrt{2}} & 0 \\
        \frac{n_1 - \i n_2}{\sqrt{2}} & 0 & \frac{n_1 - \i n_2}{\sqrt{2}} \\
        0 & \frac{n_1 - \i n_2}{\sqrt{2}} & -n_3
    }^3
    =
    \smat[0.7]{
        \frac{{n_1}^2}{2} + \frac{{n_2}^2}{2} + n_3 &
        \frac{n_3(n_1 - \i n_2)}{\sqrt{2}} &
        \frac{(n_1 - \i n_2)^2}{2} \\
        \frac{n_3(n_1 + \i n_2)}{\sqrt{2}}  &
        {n_1}^2 + {n_2}^2 &
        \frac{n_3(-n_1 + \i n_2)}{\sqrt{2}}  \\
        \frac{(n_1 + \i n_2)^2}{2} &
        \frac{n_3(-n_1 - \i n_2)}{\sqrt{2}} &
        \frac{{n_1}^2}{2} + \frac{{n_2}^2}{2} + n_3
    }
    \smat[0.7]{
        n_3 & \frac{n_1 - \i n_2}{\sqrt{2}} & 0 \\
        \frac{n_1 - \i n_2}{\sqrt{2}} & 0 & \frac{n_1 - \i n_2}{\sqrt{2}} \\
        0 & \frac{n_1 - \i n_2}{\sqrt{2}} & -n_3
    }
    =
    \left(
        {n_1}^2 + {n_2}^2 + {n_3}^2
    \right)
    \hat{n} \cdot \mathbf{s}
\end{equation*}
Platí tedy:
\begin{gather*}
    {\const{s}_j}^{n+2} =
    {\const{s}_j}^{n-1} \;
    {\const{s}_j}^3 =
    {\const{s}_j}^{n-1} \;
    {\const{s}_j} =
    {\const{s}_j}^n
    \\
    \left(\hat{n} \cdot \mathbf{s}\right)^{n+2} =
    \norm{\hat{n}} \left(\hat{n} \cdot \mathbf{s}\right)^n =
    \left(\hat{n} \cdot \mathbf{s}\right)^n
    \\
    \text{pro } n \in \mathbb{N}
    \\
\end{gather*}
\begin{align*}
    \exp \, \i \varphi \,
    \hat{n} \cdot \mathbf{s}
    &=
    \left(\exp \, \i \varphi\right)
    \sum_{n=0}^\infty
    \frac{1}{n!}
    \left(\hat{n} \cdot \mathbf{s}\right)^n
    \hspace{4em}
    \boxed{\textit{$i\varphi$ je skalár $\implies$ komutuje}}
    \\
    &=
    \left(\exp \, \i \varphi\right)
    \left(
        \frac{1}{0!}
        \left(\hat{n} \cdot \mathbf{s}\right)^0
        +
        \sum_{n=1}^\infty
        \frac{1}{2n!}
        \left(\hat{n} \cdot \mathbf{s}\right)^{2n}
        +
        \sum_{n=1}^\infty
        \frac{1}{(2n-1)!}
        \left(\hat{n} \cdot \mathbf{s}\right)^{2n-1}
    \right)
    \\
    &=
    \left(\exp \, \i \varphi\right)
    \left(
        \const{E}
        +
        \sum_{n=1}^\infty
        \frac{1}{2n!}
        \left(\hat{n} \cdot \mathbf{s}\right)^2
        +
        \sum_{n=1}^\infty
        \frac{1}{(2n-1)!}
        \left(\hat{n} \cdot \mathbf{s}\right)
    \right)
    \\
    &=
    \left(\exp \, \i \varphi\right)
    \left(
        \const{E}
        +
        \left(\hat{n} \cdot \mathbf{s}\right)^2
        \sum_{n=0}^\infty
        \frac{1}{2n!}
        +
        \left(\hat{n} \cdot \mathbf{s}\right)
        \sum_{n=0}^\infty
        \frac{1}{(2n+1)!}
    \right)
    \\
    &=
    \left(\exp \, \i \varphi\right)
    \left(
        \const{E}
        +
        \left(\hat{n} \cdot \mathbf{s}\right)^2
        \cosh(1)
        +
        \left(\hat{n} \cdot \mathbf{s}\right)
        \sinh(1)
    \right)
\end{align*}
Tento tvar může být teoreticky výhodný pro některé druhy numerických výpočtů (méně operací s maticemi pro mnoho různých $\varphi$). Jiný způsob vyjádření je:
\begin{equation*}
\begin{array}{rlll}
    \exp \, \i \varphi \,
    \hat{n} \cdot \mathbf{s}
    &\displaystyle =
    \sum_{n=0}^\infty
    \frac{1}{n!}
    \left(\i \varphi\right)^n \,
    \left(\hat{n} \cdot \mathbf{s}\right)^n
    \\[25pt]
    &\displaystyle =
    \frac{\left(\i\varphi\right)^n}{0!}
    \left(\hat{n} \cdot \mathbf{s}\right)^0
    &\displaystyle +
    \sum_{n=1}^\infty
    \frac{\left(\i\varphi\right)^{2n}}{2n!}
    \left(\hat{n} \cdot \mathbf{s}\right)^{2n}
    &\displaystyle +
    \sum_{n=1}^\infty
    \frac{\left(\i\varphi\right)^{2n-1}}{(2n-1)!}
    \left(\hat{n} \cdot \mathbf{s}\right)^{2n-1}
    \\[25pt]
    &\displaystyle =
    \const{E}
    &\displaystyle +
    \sum_{n=1}^\infty
    \frac{\left(-1\right)^n \, \varphi^{2n}}{2n!}
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    &\displaystyle +
    \sum_{n=0}^\infty
    \frac{\left(\i\varphi\right)^{2n+1}}{(2n+1)!}
    \left(\hat{n} \cdot \mathbf{s}\right)^{2n+1}
    \\[25pt]
    &\displaystyle =
    \const{E}
    -
    \frac{\left(-1\right)^0}{0!}
    \varphi^{0}
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    &\displaystyle +
    \sum_{n=0}^\infty
    \frac{\left(-1\right)^n}{2n!}
    \varphi^{2n}
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    &\displaystyle +
    \sum_{n=0}^\infty
    \i
    \frac{\left(-1\right)^n}{(2n+1)!}
    \varphi^{2n+1}
    \left(\hat{n} \cdot \mathbf{s}\right)
    \\[25pt]
    &\displaystyle =
    \const{E}
    -
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    &\displaystyle +
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    \sum_{n=0}^\infty
    \frac{\left(-1\right)^n}{2n!}
    \varphi^{2n}
    &\displaystyle +
    \left(\hat{n} \cdot \mathbf{s}\right)
    \i
    \sum_{n=0}^\infty
    \frac{\left(-1\right)^n}{(2n+1)!}
    \varphi^{2n+1}
    \\[25pt]
    &\displaystyle =
    \const{E}
    -
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    &\displaystyle +
    \left(\hat{n} \cdot \mathbf{s}\right)^2
    \cos \varphi
    &\displaystyle +
    \left(\hat{n} \cdot \mathbf{s}\right)
    \i
    \sin \varphi
\end{array}
\end{equation*}


\end{document}
